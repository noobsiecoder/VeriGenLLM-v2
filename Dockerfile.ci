# This Dockerfile onnly for GH action runs and performs:
#   1) Code lint checking
#   2) Runs tests from tests/

FROM ubuntu:22.04

# Prevent interactive prompts
ENV DEBIAN_FRONTEND=noninteractive
ENV TZ=UTC

# Install buold dependency tools
RUN apt-get update && apt-get install -y \
    curl \
    python3 \
    python3-pip \
    iverilog \
    yosys \
    && apt-get clean

# Install uv
RUN curl -LsSf https://astral.sh/uv/install.sh | sh
RUN source $HOME/.local/bin/env

WORKDIR /src # Work directory of the application
COPY . .

# Pilot run (test)
RUN uv run python main.py || echo "Expected: no argument matches"
